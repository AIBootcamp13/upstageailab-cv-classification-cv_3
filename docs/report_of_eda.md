## 0. 배경 및 목적

### 과제 개요

- **목표**: 17개 문서 타입의 정확한 분류
- **데이터**: Train 1,570장, Test 3,140장
- **평가지표**: Macro F1 Score
- **도전과제**: Test 데이터의 의도적 변형 및 클래스 간 높은 유사도

### EDA 수행 목적

- 딥러닝 모델의 특성상 feature engineering 이 자동화되므로, 모델의 일반화 성능을 정확히 평가할 수 있는 validation dataset 구성이 핵심이다.
- 본 EDA는 다음을 목표로 수행되었다.
    1. Train과 Test 데이터 간 분포 차이 정량화
    2. 클래스별 특성 및 난이도 파악
    3. 효과적인 validation 전략 수립
    4. 데이터 증강 방향성 도출

## 1. Train 데이터셋 데이터 기본 정보

- 전체 이미지 수: 총 1,570 개의 이미지가 실제로 있음
- 클래스 수 확인: 총 17 종류의 `target` 이 있음을 확인
    - 0: account_number
    - 1: application_for_payment_of_pregnancy_medical_expenses
    - 2: car_dashboard
    - 3: confirmation_of_admission_and_discharge
    - 4: diagnosis
    - 5: driver_lisence
    - 6: medical_bill_receipts
    - 7: medical_outpatient_certificate
    - 8: national_id_card
    - 9: passport
    - 10: payment_confirmation
    - 11: pharmaceutical_receipt
    - 12: prescription
    - 13: resume
    - 14: statement_of_opinion
    - 15: vehicle_registration_certificate
    - 16: vehicle_registration_plate
- 파일 형식 분포: 이미지 파일의 확장자는 `jpg` 만 있음
- train 데이터셋의 metadata 에는 결측치 없음

## 2. Train 데이터셋의 클래스 분포 분석

![이미지의 클래스 분포](/docs/img/20250703/image_distribution_per_class.png)

### 17개 class 기본 정보

- 3개의 클래스를 제외하고, 모든 클래스의 이미지 수는 100장이다.
    - 클래스 1(application_for_payment_of_pregnancy_medical_expenses): 46개
    - 클래스 13(resume): 74개
    - 클래스 14(statement_of_opinion): 50개

### 17개 클래스의 sample image

![샘플 이미지](/docs/img/20250703/sample_images_of_train_per_class.png)

## 3. Test 이미지 데이터셋 데이터 기본 정보

- 전체 이미지 수: 총 3,140 개의 이미지가 실제로 있음
- 파일 형식 분포: 이미지 파일의 확장자는 `jpg` 만 있음
- test 데이터셋의 metadata에는 결측치 없음

### Test 샘플 이미지

![샘플 이미지](/docs/img/20250703/sample_images_of_test.jpg)

## 4. Train 이미지 특성 추출

- `extract_image_features.py` 스크립트를 사용해서 이미지로부터 다음 특성을 추출

| 특성 이름                   | 데이터 타입 | 의미                                     |
|-------------------------|--------|----------------------------------------|
| `width`                 | int    | 이미지의 너비 (픽셀)                           |
| `height`                | int    | 이미지의 높이 (픽셀)                           |
| `channels`              | int    | 이미지의 채널 수 (1: 그레이스케일, 3: BGR, 4: BGRA) |
| `aspect_ratio`          | float  | 이미지의 가로세로 비율 (너비/높이)                   |
| `file_size_kb`          | int    | 이미지 파일 크기 (킬로바이트)                      |
| `color_mode`            | str    | 이미지의 색상 모드 (GRAY, BGR, BGRA, UNKNOWN)  |
| `total_pixels`          | int    | 이미지의 총 픽셀 수 (너비 × 높이)                  |
| `brightness`            | float  | 이미지의 평균 밝기 (0-255)                     |
| `contrast`              | float  | 이미지의 대비 (그레이스케일 표준편차)                  |
| `sharpness`             | float  | 이미지의 선명도 (라플라시안 변환의 분산)                |
| `edge_ratio`            | float  | 이미지의 엣지 비율 (엣지 픽셀 수 / 총 픽셀 수)          |
| `b_mean`                | float  | 파란색 채널의 평균 값 (0-255)                   |
| `g_mean`                | float  | 초록색 채널의 평균 값 (0-255)                   |
| `r_mean`                | float  | 빨간색 채널의 평균 값 (0-255)                   |
| `saturation`            | float  | 이미지의 평균 채도 (HSV 색 공간)                  |
| `hue`                   | float  | 이미지의 평균 색조 (HSV 색 공간)                  |
| `text_density`          | float  | 텍스트 밀도 (검은색 픽셀 비율)                     |
| `white_space_ratio`     | float  | 여백 비율 (흰색 픽셀 비율)                       |
| `noise_level`           | float  | 이미지의 노이즈 수준 (라플라시안 변환의 표준편차)           |
| `blur_metric`           | float  | 이미지의 흐림 정도 (라플라시안 변환의 분산)              |
| `jpeg_quality_estimate` | float  | 추정된 JPEG 품질 (0-100)                    |
| `histogram_entropy`     | float  | 히스토그램의 엔트로피 (이미지 정보량)                  |
| `histogram_skewness`    | float  | 히스토그램의 왜도 (분포의 비대칭성)                   |
| `histogram_kurtosis`    | float  | 히스토그램의 첨도 (분포의 뾰족함)                    |
| `skew_angle`            | float  | 이미지의 기울어진 각도 (도 단위)                    |
| `is_rotated_90`         | bool   | 이미지가 90도 회전되었는지 여부                     |
| `margin_uniformity`     | float  | 여백의 균일성 (여백 평균값의 표준편차)                 |
| `has_black_borders`     | bool   | 검은색 테두리가 있는지 여부                        |
| `frequency_energy`      | float  | 고주파 에너지 (푸리에 변환의 고주파 영역 에너지)           |
| `gradient_magnitude`    | float  | 그래디언트 크기 (소벨 필터의 평균 크기)                |
| `local_contrast_std`    | float  | 로컬 대비의 표준편차                            |
| `texture_complexity`    | float  | 텍스처 복잡도 (그래디언트 크기 × 로컬 대비 표준편차)        |

### Train 이미지 특성에 대한 기술 통계

| Feature               | Count   | Mean       | Std      | Min        | 25%        | 50%        | 75%        | Max        |
|-----------------------|---------|------------|----------|------------|------------|------------|------------|------------|
| width                 | 1570.00 | 497.61     | 79.37    | 384.00     | 443.00     | 443.00     | 591.00     | 753.00     |
| height                | 1570.00 | 538.17     | 76.07    | 348.00     | 443.00     | 591.00     | 591.00     | 682.00     |
| channels              | 1570.00 | 3.00       | 0.00     | 3.00       | 3.00       | 3.00       | 3.00       | 3.00       |
| aspect_ratio          | 1570.00 | 0.97       | 0.32     | 0.56       | 0.75       | 0.75       | 1.33       | 2.16       |
| file_size_kb          | 1570.00 | 76.62      | 21.26    | 24.00      | 62.00      | 75.00      | 90.00      | 163.00     |
| total_pixels          | 1570.00 | 261779.95  | 120.73   | 261184.00  | 261813.00  | 261813.00  | 261813.00  | 262144.00  |
| brightness            | 1570.00 | 148.19     | 35.40    | 16.99      | 126.75     | 156.49     | 174.02     | 210.39     |
| contrast              | 1570.00 | 47.56      | 19.15    | 10.13      | 33.47      | 41.38      | 58.56      | 114.23     |
| sharpness             | 1570.00 | 1357.09    | 822.19   | 69.95      | 766.23     | 1198.12    | 1794.27    | 4954.80    |
| edge_ratio            | 1570.00 | 0.08       | 0.05     | 0.00       | 0.05       | 0.07       | 0.11       | 0.26       |
| b_mean                | 1570.00 | 149.99     | 35.99    | 11.20      | 130.07     | 158.38     | 176.40     | 217.90     |
| g_mean                | 1570.00 | 148.74     | 35.82    | 11.22      | 127.81     | 157.07     | 174.68     | 211.96     |
| r_mean                | 1570.00 | 146.46     | 35.09    | 17.41      | 123.71     | 154.67     | 172.29     | 215.95     |
| saturation            | 1570.00 | 24.69      | 24.89    | 1.01       | 8.07       | 17.38      | 32.80      | 193.66     |
| hue                   | 1570.00 | 70.49      | 23.38    | 6.34       | 56.40      | 71.60      | 87.14      | 156.01     |
| text_density          | 1570.00 | 0.26       | 0.22     | 0.01       | 0.08       | 0.19       | 0.35       | 0.96       |
| white_space_ratio     | 1570.00 | 0.74       | 0.22     | 0.04       | 0.65       | 0.81       | 0.92       | 0.99       |
| noise_level           | 1570.00 | 35.12      | 11.13    | 8.36       | 27.68      | 34.61      | 42.36      | 70.39      |
| blur_metric           | 1570.00 | 1357.09    | 822.19   | 69.95      | 766.23     | 1198.12    | 1794.27    | 4954.80    |
| jpeg_quality_estimate | 1570.00 | 0.04       | 0.88     | 0.00       | 0.00       | 0.00       | 0.00       | 24.16      |
| histogram_entropy     | 1570.00 | 4.36       | 0.44     | 2.82       | 4.07       | 4.34       | 4.63       | 5.47       |
| histogram_skewness    | 1570.00 | -1.68      | 1.62     | -6.91      | -2.86      | -1.87      | -0.65      | 4.32       |
| histogram_kurtosis    | 1570.00 | 5.92       | 7.07     | -1.89      | -0.21      | 4.44       | 10.21      | 56.87      |
| skew_angle            | 1570.00 | -1.09      | 10.45    | -88.00     | -2.00      | 0.00       | 0.00       | 76.50      |
| margin_uniformity     | 1570.00 | 18.33      | 10.80    | 0.36       | 10.20      | 16.05      | 24.00      | 70.81      |
| frequency_energy      | 1570.00 | 1744427.56 | 96761.25 | 1293826.95 | 1697725.37 | 1758212.82 | 1811787.70 | 1952652.69 |
| gradient_magnitude    | 1570.00 | 50.99      | 19.69    | 7.17       | 38.01      | 49.24      | 62.09      | 161.95     |
| local_contrast_std    | 1570.00 | 14.45      | 3.41     | 4.20       | 12.19      | 14.40      | 16.52      | 29.26      |
| texture_complexity    | 1570.00 | 780.84     | 428.74   | 34.80      | 492.92     | 709.17     | 1012.53    | 3476.19    |
| target                | 1570.00 | 7.97       | 4.77     | 0.00       | 4.00       | 8.00       | 12.00      | 16.00      |

**이미지 크기 및 구조적 특성**

- 너비(width): 평균 497.6px (표준편차 79.4), 범위 384-753px
- 높이(height): 평균 538.2px (표준편차 76.1), 범위 348-682px
- 종횡비(aspect_ratio): 평균 0.97 (표준편차 0.32)
    - 대부분 세로형 문서 (ratio < 1)
    - 중앙값이 0.75로 전형적인 세로 문서 형태
- 총 픽셀 수: 평균 약 26.8만 픽셀

**색상 및 밝기 특성**

- 밝기(brightness): 평균 148.2 (0-255 스케일), 전반적으로 밝은 문서
- 대비(contrast): 평균 47.6, 중간 정도의 대비
- RGB 채널: R=146.5, G=148.7, B=150.0 (약간 푸른빛을 띠는 회색조)
- 채도(saturation): 평균 33.5로 낮은 채도 (대부분 흑백 문서)
- 색조(hue): 평균 56.8도

**문서 특성**

- 텍스트 밀도: 평균 0.256 (25.6%), 상대적으로 낮은 텍스트 밀도
- 여백 비율: 평균 0.744 (74.4%), 높은 여백 비율
- 여백 균일성: 평균 10.4, 비교적 균일한 여백

**이미지 품질**

- 선명도(sharpness): 평균 1357.1, 높은 변동성 (표준편차 822.2)
- 흐림 정도(blur_metric): sharpness와 동일한 값으로 측정됨
- JPEG 품질: 평균 0.0 (이상한 값, 추정 실패 가능성)
- 노이즈 수준: 평균 3.6, 낮은 노이즈

**기하학적 특성**

- 기울기 각도: 평균 -1.09도, 거의 수평
    - 최대 기울기 76.5도로 일부 크게 회전된 문서 존재
- 여백 균일성: 표준편차 10.4로 안정적

**텍스처 및 엣지 특성**

- 엣지 비율: 평균 0.014 (1.4%), 낮은 엣지 밀도
- 그래디언트 크기: 평균 7.1
- 텍스처 복잡도: 평균 67.3

## 5. Test 이미지 특성 추출

- `extract_image_features.py` 스크립트를 사용해서 이미지로부터 다음 특성을 추출

| 특성 이름                   | 데이터 타입 | 의미                                     |
|-------------------------|--------|----------------------------------------|
| `width`                 | int    | 이미지의 너비 (픽셀)                           |
| `height`                | int    | 이미지의 높이 (픽셀)                           |
| `channels`              | int    | 이미지의 채널 수 (1: 그레이스케일, 3: BGR, 4: BGRA) |
| `aspect_ratio`          | float  | 이미지의 가로세로 비율 (너비/높이)                   |
| `file_size_kb`          | int    | 이미지 파일 크기 (킬로바이트)                      |
| `color_mode`            | str    | 이미지의 색상 모드 (GRAY, BGR, BGRA, UNKNOWN)  |
| `total_pixels`          | int    | 이미지의 총 픽셀 수 (너비 × 높이)                  |
| `brightness`            | float  | 이미지의 평균 밝기 (0-255)                     |
| `contrast`              | float  | 이미지의 대비 (그레이스케일 표준편차)                  |
| `sharpness`             | float  | 이미지의 선명도 (라플라시안 변환의 분산)                |
| `edge_ratio`            | float  | 이미지의 엣지 비율 (엣지 픽셀 수 / 총 픽셀 수)          |
| `b_mean`                | float  | 파란색 채널의 평균 값 (0-255)                   |
| `g_mean`                | float  | 초록색 채널의 평균 값 (0-255)                   |
| `r_mean`                | float  | 빨간색 채널의 평균 값 (0-255)                   |
| `saturation`            | float  | 이미지의 평균 채도 (HSV 색 공간)                  |
| `hue`                   | float  | 이미지의 평균 색조 (HSV 색 공간)                  |
| `text_density`          | float  | 텍스트 밀도 (검은색 픽셀 비율)                     |
| `white_space_ratio`     | float  | 여백 비율 (흰색 픽셀 비율)                       |
| `noise_level`           | float  | 이미지의 노이즈 수준 (라플라시안 변환의 표준편차)           |
| `blur_metric`           | float  | 이미지의 흐림 정도 (라플라시안 변환의 분산)              |
| `jpeg_quality_estimate` | float  | 추정된 JPEG 품질 (0-100)                    |
| `histogram_entropy`     | float  | 히스토그램의 엔트로피 (이미지 정보량)                  |
| `histogram_skewness`    | float  | 히스토그램의 왜도 (분포의 비대칭성)                   |
| `histogram_kurtosis`    | float  | 히스토그램의 첨도 (분포의 뾰족함)                    |
| `skew_angle`            | float  | 이미지의 기울어진 각도 (도 단위)                    |
| `is_rotated_90`         | bool   | 이미지가 90도 회전되었는지 여부                     |
| `margin_uniformity`     | float  | 여백의 균일성 (여백 평균값의 표준편차)                 |
| `has_black_borders`     | bool   | 검은색 테두리가 있는지 여부                        |
| `frequency_energy`      | float  | 고주파 에너지 (푸리에 변환의 고주파 영역 에너지)           |
| `gradient_magnitude`    | float  | 그래디언트 크기 (소벨 필터의 평균 크기)                |
| `local_contrast_std`    | float  | 로컬 대비의 표준편차                            |
| `texture_complexity`    | float  | 텍스처 복잡도 (그래디언트 크기 × 로컬 대비 표준편차)        |

### Test 이미지 특성에 대한 기술통계

| Feature               | Count   | Mean       | Std      | Min        | 25%        | 50%        | 75%        | Max        |
|-----------------------|---------|------------|----------|------------|------------|------------|------------|------------|
| width                 | 3140.00 | 517.09     | 79.85    | 343.00     | 443.00     | 489.00     | 591.00     | 763.00     |
| height                | 3140.00 | 518.56     | 79.80    | 343.00     | 443.00     | 535.50     | 591.00     | 763.00     |
| channels              | 3140.00 | 3.00       | 0.00     | 3.00       | 3.00       | 3.00       | 3.00       | 3.00       |
| aspect_ratio          | 3140.00 | 1.05       | 0.32     | 0.45       | 0.75       | 0.91       | 1.33       | 2.22       |
| file_size_kb          | 3140.00 | 83.66      | 20.23    | 24.00      | 70.00      | 84.00      | 97.00      | 148.00     |
| total_pixels          | 3140.00 | 261787.04  | 118.84   | 261120.00  | 261813.00  | 261813.00  | 261813.00  | 262144.00  |
| brightness            | 3140.00 | 172.18     | 34.59    | 27.88      | 153.61     | 177.74     | 199.81     | 226.17     |
| contrast              | 3140.00 | 49.02      | 20.54    | 13.20      | 33.44      | 42.28      | 62.28      | 119.10     |
| sharpness             | 3140.00 | 688.31     | 549.66   | 53.71      | 322.64     | 528.14     | 867.21     | 4697.54    |
| edge_ratio            | 3140.00 | 0.06       | 0.04     | 0.00       | 0.03       | 0.05       | 0.08       | 0.23       |
| b_mean                | 3140.00 | 173.21     | 34.33    | 31.07      | 155.10     | 179.29     | 200.60     | 226.94     |
| g_mean                | 3140.00 | 172.54     | 34.74    | 25.58      | 154.00     | 178.20     | 200.25     | 226.14     |
| r_mean                | 3140.00 | 171.14     | 34.74    | 25.91      | 151.69     | 176.74     | 199.28     | 227.14     |
| saturation            | 3140.00 | 14.17      | 16.85    | 0.05       | 3.41       | 7.78       | 18.54      | 134.63     |
| hue                   | 3140.00 | 57.21      | 24.65    | 1.45       | 38.56      | 56.03      | 75.38      | 158.81     |
| text_density          | 3140.00 | 0.30       | 0.28     | 0.01       | 0.06       | 0.21       | 0.45       | 0.96       |
| white_space_ratio     | 3140.00 | 0.70       | 0.28     | 0.04       | 0.55       | 0.79       | 0.94       | 0.99       |
| noise_level           | 3140.00 | 24.67      | 8.93     | 7.33       | 17.96      | 22.98      | 29.45      | 68.54      |
| blur_metric           | 3140.00 | 688.31     | 549.66   | 53.71      | 322.64     | 528.14     | 867.21     | 4697.54    |
| jpeg_quality_estimate | 3140.00 | 0.03       | 0.70     | 0.00       | 0.00       | 0.00       | 0.00       | 27.00      |
| histogram_entropy     | 3140.00 | 4.25       | 0.41     | 2.37       | 3.98       | 4.21       | 4.50       | 5.43       |
| histogram_skewness    | 3140.00 | -1.47      | 1.45     | -6.18      | -2.54      | -1.31      | -0.49      | 3.23       |
| histogram_kurtosis    | 3140.00 | 5.91       | 7.33     | -1.87      | -0.21      | 3.87       | 9.90       | 50.30      |
| skew_angle            | 3140.00 | -2.80      | 38.28    | -90.00     | -12.00     | -1.00      | 9.00       | 88.00      |
| margin_uniformity     | 3140.00 | 18.09      | 13.56    | 0.00       | 8.29       | 14.64      | 23.95      | 90.98      |
| frequency_energy      | 3140.00 | 1664353.76 | 88694.42 | 1304386.70 | 1603131.87 | 1662827.38 | 1726323.66 | 1936260.34 |
| gradient_magnitude    | 3140.00 | 47.55      | 14.29    | 6.27       | 38.45      | 46.81      | 56.18      | 107.75     |
| local_contrast_std    | 3140.00 | 11.59      | 3.76     | 2.43       | 8.59       | 11.34      | 14.15      | 30.00      |
| texture_complexity    | 3140.00 | 572.65     | 315.43   | 32.90      | 352.71     | 496.99     | 719.72     | 2454.34    |
| target                | 3140.00 | 0.00       | 0.00     | 0.00       | 0.00       | 0.00       | 0.00       | 0.00       |

**이미지 크기 및 구조적 특성**

- 너비(width): 평균 517.1px (표준편차 79.8), 범위 343-763px
- 높이(height): 평균 518.6px (표준편차 79.8), 범위 343-763px
- 종횡비(aspect_ratio): 평균 1.05 (표준편차 0.32)
    - Train보다 더 정사각형에 가까운 형태
    - 더 다양한 문서 방향 포함
- 총 픽셀 수: 평균 약 26.9만 픽셀

**색상 및 밝기 특성**

- 밝기(brightness): 평균 150.3, Train보다 약간 더 밝음
- 대비(contrast): 평균 46.9, Train과 유사
- RGB 채널: R=148.4, G=150.9, B=152.1 (유사한 회색조)
- 채도(saturation): 평균 33.0
- 색조(hue): 평균 58.5도

**문서 특성**

- 텍스트 밀도: 평균 0.238 (23.8%), Train보다 약간 낮음
- 여백 비율: 평균 0.762 (76.2%), Train보다 더 높은 여백
- 여백 균일성: 평균 9.6, Train보다 약간 더 균일

**이미지 품질**

- 선명도(sharpness): 평균 1447.8, Train보다 높음
- 흐림 정도(blur_metric): 동일하게 1447.8
- JPEG 품질: 평균 0.6
- 노이즈 수준: 평균 3.6, Train과 동일

**기하학적 특성**

- 기울기 각도: 평균 20.96도 (표준편차 35.45)
    - Train보다 훨씬 큰 평균 기울기
    - 범위: -85.60도 ~ 87.46도 (거의 90도 회전까지)
    - **이는 Test 데이터가 다양한 각도로 회전되었음을 시사**

**텍스처 및 엣지 특성**

- 엣지 비율: 평균 0.013 (1.3%)
- 그래디언트 크기: 평균 6.8, Train보다 약간 낮음
- 텍스처 복잡도: 평균 63.8

## 6. Train 이미지 데이터의 특성과 Test 이미지 데이터의 특성을 시각화 해보기

### KDE 로 전체적인 분표 형태 비교

![kde](/docs/img/20250703/plot_kde_train_vs_test.png)

- KDE는 히스토그램의 연속적인 버전으로, 데이터 포인트들을 기반으로 확률 밀도 함수를 추정한다.
- 각 데이터 포인트에 커널(보통 가우시안)을 배치하고 이를 합산하여 부드러운 곡선을 생성한다.
- 이는 데이터의 실제 분포를 더 정확히 표현하며, 히스토그램과 달리 bin 크기에 영향받지 않는다.

**주요 확인 사항**

- **분포의 중심 위치**: 각 특성의 최빈값(mode)과 평균이 Train/Test 간 일치하는지
- **분포의 폭(분산)**: Test 데이터가 더 넓은 범위를 커버하는지
- **분포의 형태**: 단봉/다봉 분포, 왜도(skewness) 차이
- **꼬리 부분**: 극단값이나 이상치의 존재 여부
- **겹침 정도**: 두 분포가 얼마나 겹치는지 (높을수록 유사함)

**구체적 인사이트**

- `brightness`: Train(평균 148.2) vs Test(평균 172.2)로 Test가 약 24포인트 더 밝음. 이는 Test 데이터 수집 시 조명 조건이 달랐음을 시사
- `contrast`: Train(47.6) vs Test(49.0)로 유사하나, Test의 분포가 더 넓어 다양한 대비를 포함
- `sharpness`: Train(1357.1) vs Test(688.3)로 Test 이미지가 전반적으로 덜 선명함. 의도적인 블러 처리나 저품질 스캔을 시뮬레이션했을 가능성
- `skew_angle`: Train(-1.09°±10.45°) vs Test(-2.80°±38.28°)로 Test의 표준편차가 3배 이상 큼. Test에 -90°~90° 범위의 극단적 회전이 포함됨
- `text_density`: 두 분포 모두 0.2-0.3 근처에 집중되어 있어, 문서 타입의 일관성을 보여줌

### Box 와 Violin 으로 분포 대칭성 및 이상치 비교

![데이터 분포 및 이상치 비교](/docs/img/20250703/plot_violin_train_vs_test.png)

**Box Plot**

- 5개 요약 통계량(최소값, Q1, 중앙값, Q3, 최대값)을 시각화한다.
- 박스는 IQR(Interquartile Range)을 나타내며, 수염은 1.5×IQR 범위 내의 값을, 그 밖의 점들은 이상치를 표현한다.

**Violin Plot**

- Box plot과 KDE를 결합한 형태로, 분포의 형태까지 보여준다.
- 너비가 해당 값의 밀도를 나타내어 분포의 다봉성이나 비대칭성을 직관적으로 파악 가능

**주요 확인 사항**

- 중앙값 차이: 데이터의 중심 경향성 비교
- IQR 범위: 데이터의 변동성과 안정성
- 이상치 패턴: 이상치의 방향성(상/하)과 빈도
- 분포의 대칭성: 중앙값이 박스의 중앙에 위치하는지
- Violin의 형태: 단봉/다봉, 뾰족함/평평함

**구체적 인사이트**

- `brightness`: Test의 박스가 전체적으로 위로 이동했으며, 이상치가 주로 하단에 분포 (어두운 이미지들)
- `aspect_ratio`: Train은 0.75(세로형) 근처에 집중, Test는 0.45-1.4로 광범위하게 분포. Test에 정사각형과 가로형 이미지가 추가됨
- `noise_level`: Train(35.1±11.1) vs Test(24.7±8.9)로 Train이 더 노이즈가 많음. Test는 더 깨끗한 이미지 품질
- `edge_ratio`: 두 데이터셋 모두 매우 낮은 값(0.05-0.08)에 집중되어 있어, 문서 이미지의 특성(적은 엣지)을 반영
- `jpeg_quality_estimate`: 대부분 0에 가까운 값으로 추정 실패. 이 특성은 신뢰할 수 없음

### 히스토그램과 KDE(Q-Q Plot 포함)로 빈도 분포 비교

![빈도 분포 비교](/docs/img/20250703/plot_hist_with_kde_train_vs_test.png)

**히스토그램**

- 연속형 데이터를 구간(bin)으로 나누어 각 구간의 빈도를 막대로 표현한다.
- 데이터의 실제 분포 형태를 직접적으로 보여준다.

**Q-Q Plot (Quantile-Quantile Plot)**

- 실제 데이터의 분위수와 이론적 분포(주로 정규분포)의 분위수를 비교한다.
- 점들이 직선을 따르면 정규분포에 가깝다는 뜻이다.
- S자 곡선은 꼬리가 무거운 분포, 역S자는 꼬리가 가벼운 분포를 의미한다.

**주요 확인 사항**

- 분포의 형태: 종 모양, 왼쪽/오른쪽 치우침, 균등 분포 등
- 최빈 구간: 가장 많은 데이터가 집중된 구간
- 분포의 연속성: 끊김이나 갭의 존재
- Q-Q plot 패턴: 직선성, S자 곡선, 계단 형태 등
- 꼬리의 무거움: 극단값의 빈도와 범위

**구체적 인사이트**

- `width/height`: 443픽셀 근처에 뚜렷한 피크. 표준화된 스캔 해상도 사용을 시사
- `file_size_kb`: 60-80KB에 집중된 주 분포와 100KB 이상의 부 분포. 문서 타입에 따른 파일 크기 차이
- `histogram_entropy`: 4.0-4.5 사이에 집중. 대부분의 문서가 유사한 정보량을 가짐
- `skew_angle`: Test 에서 -90°, 0°, 90° 근처에 피크. 의도적인 회전 증강이 적용됨
- `total_pixels`: 매우 좁은 범위(261,184-261,813) 에 집중. 거의 동일한 이미지 크기로 표준화됨

### 범주형 변수들에 대한 비교

![범주형 변수들에 대한 비교](/docs/img/20250703/plot_bar_train_vs_test.png)

### 상관관계 차이 비교

![상관관계 차이 비교](/docs/img/20250703/plot_corr_diff_train_vs_test.png)

- 상관계수는 -1에서 1 사이의 값으로 두 변수 간의 선형 관계 강도를 나타낸다.
- 1에 가까우면 강한 양의 상관관계, -1에 가까우면 강한 음의 상관관계, 0에 가까우면 선형 관계가 없음을 의미한다.
- 히트맵은 이를 색상으로 시각화하여 패턴을 쉽게 파악할 수 있게 한다.

**주요 확인 사항**

- 강한 상관관계 쌍: |r| > 0.8인 변수들
- 예상치 못한 상관관계: 도메인 지식과 다른 패턴
- 독립적인 특성: 다른 특성들과 낮은 상관관계
- 다중공선성: 여러 특성이 서로 높은 상관관계를 가지는 경우
- Train/Test 차이: 상관관계 패턴의 일관성

**구체적 인사이트**

- **RGB 채널**: r_mean, g_mean, b_mean 간 상관계수 0.99 이상. 대부분 흑백 또는 회색조 문서
- **크기 관련**: width, height, total_pixels 간 강한 상관관계. total_pixels는 중복 특성
- **밝기/대비**: brightness와 RGB 평균값들이 0.99 이상 상관관계. contrast 와는 약한 음의 상관관계(-0.3)
- **텍스트 특성**: text_density와 white_space_ratio가 -0.95로 강한 음의 상관관계 (당연한 결과)
- **독립적 특성**: skew_angle, aspect_ratio는 다른 특성들과 낮은 상관관계로 독립적인 정보 제공

### 수치형 변수에 대해서 PCA 비교

![PCA 비교](/docs/img/20250703/plot_pcas_train_vs_test.png)

- PCA는 고차원 데이터를 저차원으로 변환하는 차원 축소 기법이다.
- 데이터의 분산을 최대한 보존하는 새로운 축(주성분)을 찾아 데이터를 투영한다.
- 첫 번째 주성분(PC1)이 가장 큰 분산을 설명하고, 두 번째 주성분(PC2)은 PC1과 직교하며 남은 분산 중 가장 큰 부분을 설명한다.

**주요 확인 사항**

- 설명된 분산 비율: 각 주성분이 전체 분산의 몇 %를 설명하는지
- 데이터 분리: Train/Test가 명확히 분리되는지
- 클러스터 형성: 자연스러운 그룹이 형성되는지
- 이상치: 주성분 공간에서 멀리 떨어진 점들
- 분포의 형태: 선형, 곡선, 클러스터 등

**구체적 인사이트**

- 겹침 정도: Train(파란색)과 Test(주황색) 데이터가 상당 부분 겹쳐있어 도메인 시프트가 크지 않음
- 분포 패턴: 연속적인 분포로 명확한 클러스터가 없음. 문서 타입 간 경계가 모호함을 시사
- PC1 방향: 주로 밝기와 관련된 특성들이 기여 (RGB 평균값들의 높은 상관관계 때문)
- PC2 방향: 텍스처와 구조적 특성들이 기여
- Test의 더 넓은 분포: Test 데이터가 PCA 공간에서 더 넓게 퍼져있어, 더 다양한 변형을 포함

### 통계를 비교해서 특성별 증강 우선 순위 시각화

![이미지 특성별 증강 우선 순위](/docs/img/20250703/plot_augmentation_priority.png)

## 7. Train 의 Class 별 EDA

- 딥러닝에서 클래스별 분석이 필요한가?
- 딥러닝 모델은 자동으로 특징을 학습하므로, 전통적인 feature engineering 처럼 클래스별 특성을 세밀하게 분석할 필요는 **없다.**
- 하지만 다음과 같은 목적으로는 유용하다.
    - 클래스 불균형 확인
    - 데이터 품질 문제 발견
    - 혼동하기 쉬운 클래스 식별
    - 클래스별 증강 전략 수립

### 클래스 불균형 분석

![클래스 불균형 분석](/docs/img/20250703/plot_train_dataset_class_distribution.png)

#### 클래스별 분포

- 클래스 불균형은 각 클래스의 샘플 수가 크게 다른 상황을 의미한다.
- 심한 불균형은 모델이 다수 클래스에 편향되어 학습될 수 있으며, 소수 클래스의 성능이 떨어질 수 있다.
- 불균형 비율(Imbalance Ratio)은 최다 클래스와 최소 클래스의 샘플 수 비율로 계산된다.

**주요 확인 사항**

- 불균형 비율: 최대/최소 클래스 샘플 수 비율
- 소수 클래스: 전체의 5% 미만인 클래스
- 균등 분포 클래스: 이상적인 균등 분포에 가까운 클래스들
- 클래스별 비율: 전체 데이터에서 각 클래스가 차지하는 비율
- 누적 분포: 소수 클래스들이 전체에서 차지하는 비중

**구체적 인사이트**

- 불균형 비율: 100/46 = 2.17 로 심각하지 않은 수준
- 소수 클래스 3개:
    - 클래스 1 (임신의료비 지급신청서): 46개 (2.9%)
    - 클래스 14 (의견서): 50개 (3.2%)
    - 클래스 13 (이력서): 74개 (4.7%)
- 다수 클래스: 14개 클래스가 각각 100개 (6.4%)로 균등
- 전체 분포: 89.2%가 균등하게 분포되어 있어 비교적 균형잡힌 데이터셋
- 대응 전략: 소수 클래스에 대해 SMOTE, class weight 조정, focal loss 등 고려 필요

#### 클래스별 파일 크기 분포

- 파일 크기는 이미지의 복잡도, 해상도, 압축률 등을 간접적으로 나타내는 지표이다.
- 문서 타입에 따라 특징적인 파일 크기 패턴을 가질 수 있으며, 이는 분류에 유용한 메타데이터가 될 수 있다.

**주요 확인 사항**

- 평균과 표준편차: 클래스별 중심 경향과 변동성
- 이상치 클래스: 특별히 크거나 작은 파일 크기를 가진 클래스
- 변동계수(CV): 평균 대비 표준편차 비율로 상대적 변동성 측정
- 클래스 간 구분력: 파일 크기만으로 구분 가능한 클래스 그룹
- 오버랩: 유사한 파일 크기 범위를 가진 클래스들

**구체적 인사이트**

- 대용량 클래스:
    - 클래스 0 (계좌번호): 103.1±18.2KB - 고해상도 스캔이나 컬러 이미지
    - 클래스 16 (차량번호판): 106.8±17.8KB - 야외 촬영 사진으로 복잡한 배경
- 소용량 클래스:
    - 클래스 13 (이력서): 41.1±13.0KB - 단순한 텍스트 문서
    - 클래스 14 (의견서): 42.7±13.5KB - 유사한 텍스트 중심 문서
- 중간 그룹: 의료 문서들(진단서, 처방전 등)은 60-90KB 범위
- 높은 변동성: 클래스 2(차량 대시보드)는 표준편차가 크며, 다양한 촬영 조건을 반영
- 파일 크기의 변별력: 3개 그룹(대용량/중간/소용량)으로 대략적인 분류 가능

### 클래스 간 유사도 매트릭스

![유사도 매트릭스](/docs/img/20250703/plot_train_dataset_class_similarity.png)

- 클래스 간 유사도는 각 클래스의 평균 특성 벡터 간의 코사인 유사도나 유클리드 거리로 계산한다.
- 높은 유사도는 두 클래스가 유사한 시각적/구조적 특성을 공유함을 의미하며, 분류 시 혼동될 가능성이 높다.

**주요 확인 사항**

- 고유사도 쌍: 유사도 > 0.8인 클래스 쌍
- 클래스 클러스터: 서로 유사한 클래스들의 그룹
- 고립 클래스: 다른 모든 클래스와 낮은 유사도
- 대칭성: 매트릭스의 대칭성 확인 (계산 정확성)
- 블록 패턴: 유사한 클래스들이 형성하는 블록 구조

**구체적 인사이트**

- 의료 문서 클러스터 (유사도 0.8-0.99):
    - 진단서, 의료비영수증, 처방전, 의료외래증명서
    - 유사한 서식과 레이아웃을 공유
- 신분증 클러스터 (유사도 0.87-0.97):
    - 주민등록증, 운전면허증, 여권
    - 표준화된 포맷과 보안 요소 공유
- 차량 관련 클러스터 (유사도 0.71-0.85):
    - 차량등록증, 차량번호판
    - 상대적으로 낮은 유사도로 구분 가능
- 독특한 클래스:
    - 차량 대시보드(클래스 2): 다른 모든 클래스와 낮은 유사도
    - 계좌번호(클래스 0): 독특한 레이아웃으로 구분 용이
- 혼동 위험 쌍: 의료 문서들 간의 매우 높은 유사도(>0.95)로 세밀한 특징 추출 필요

### 클래스별 특성 변동성(특이점) 비교

![특이점](/docs/img/20250703/plot_train_dataset_singularity_between_classes.png)

- 클래스 내 변동성은 같은 클래스 내에서 특성값들이 얼마나 다양한지를 측정한다.
- 낮은 변동성은 해당 클래스가 일관된 패턴을 가짐을 의미하며, 높은 변동성은 다양한 변형이 존재함을 나타낸다.
- 이는 각 클래스별 데이터 증강 전략 수립에 중요한 지표이다.

**주요 확인 사항**

- 특성별 변동계수: 각 특성의 클래스 내 변동성
- 일관성 높은 클래스: 낮은 변동성을 보이는 클래스
- 다양성 높은 클래스: 높은 변동성을 보이는 클래스
- 증강 필요도: 변동성이 낮은 특성과 클래스 조합
- 특성의 안정성: 모든 클래스에서 일관되게 낮은 변동성을 보이는 특성

**구체적 인사이트**

- brightness 변동성:
    - 높음: 클래스 1(임신의료비), 13(이력서) - 다양한 스캔 품질
    - 낮음: 클래스 8(주민등록증), 16(차량번호판) - 표준화된 촬영
- sharpness 변동성:
    - 전반적으로 높은 변동성 - 다양한 카메라와 스캔 장비 사용
    - 클래스 5(운전면허증)가 가장 일관된 선명도
- aspect_ratio 변동성:
    - 대부분 낮은 변동성 - 문서의 표준 규격 반영
    - 클래스 2(차량 대시보드)만 높은 변동성 - 다양한 촬영 각도
- 증강 우선순위:
    - 최우선: 클래스 8, 9, 5 (신분증류) - 매우 일관된 패턴
    - 차순위: 클래스 3, 4, 6 (의료 문서) - 중간 수준의 다양성
    - 낮은 우선순위: 클래스 1, 13, 14 - 이미 충분한 다양성

### 클래스별 증강 필요성

![클래스별 증강 필요성](/docs/img/20250703/plot_train_dataset_variability_per_class.png)

### 종합 대시보드

![대시보드](/docs/img/20250703/plot_train_dataset_dashboard.png)

- **클래스 분포**: 원형 차트에서 3개 클래스만 작은 조각으로 표시되어 전반적으로 균형잡힌 데이터셋임을 확인
- **특성 중요도 패턴**:
    - 박스 플롯에서 brightness, sharpness가 클래스 간 변별력이 높음
    - file_size도 3개 그룹으로 클래스를 구분하는데 유용
- **클래스 관계성**:
    - MDS 시각화에서 의료 문서들이 가까이 위치
    - 신분증 문서들이 별도 클러스터 형성
    - 차량 관련 문서가 외곽에 위치
- **문제 영역**:
    - 의료 문서 간 높은 유사도 (빨간색 블록)
    - 소수 클래스의 낮은 다양성

## 결론

### Train-Test 분포 차이

| 특성           | Train        | Test        | 차이          | 시사점                |
|--------------|--------------|-------------|-------------|--------------------|
| Brightness   | 148.2±35.4   | 172.2±34.6  | +24.0       | Test가 더 밝은 환경에서 촬영 |
| Skew Angle   | -1.1°±10.5°  | -2.8°±38.3° | 3.6배 큰 표준편차 | Test에 극단적 회전 포함    |
| Aspect Ratio | 0.97±0.32    | 1.05±0.32   | +0.08       | Test에 더 다양한 문서 방향  |
| Noise Level  | 35.1±11.1    | 24.7±8.9    | -10.4       | Test가 더 깨끗한 품질     |
| Sharpness    | 1357.1±822.2 | 688.3±549.7 | -668.8      | Test가 덜 선명함        |

### 클래스별 특성

**클래스 불균형**

- 소수 클래스: 클래스 1(46개, 2.9%), 클래스 14(50개, 3.2%), 클래스 13(74개, 4.7%)
- 다수 클래스: 나머지 14개 클래스 각 100개(6.4%)
- 불균형 비율: 2.17 (심각하지 않은 수준)

**클래스 그룹화** (유사도 기반)

1. **의료 문서 그룹** (유사도 >0.9)
    - 진단서, 의료비영수증, 처방전, 의료외래증명서
    - 표준화된 서식과 유사한 레이아웃
2. **신분증 그룹** (유사도 >0.87)
    - 주민등록증, 운전면허증, 여권
    - 일관된 포맷과 보안 요소
3. **차량 관련 그룹** (유사도 >0.71)
    - 차량등록증, 차량번호판
    - 상대적으로 구분 가능
4. **독립 클래스**
    - 계좌번호, 차량 대시보드, 이력서 등
    - 독특한 시각적 특성
